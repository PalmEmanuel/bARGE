{
  "name": "Azure Resource Graph KQL",
  "scopeName": "source.kql.arg",
  "fileTypes": [
    "kql"
  ],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#keywords"
    },
    {
      "include": "#operators"
    },
    {
      "include": "#functions"
    },
    {
      "include": "#tables"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#properties"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.kql",
          "match": "//.*$"
        },
        {
          "name": "comment.block.kql",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.kql",
          "match": "(?i)\\b(!between|!contains|!contains_cs|!endswith|!endswith_cs|!has|!has_cs|!hasprefix|!hasprefix_cs|!hassuffix|!hassuffix_cs|!in|!in~|!startswith|!startswith_cs|3Dchart|__contextual_datatable|__crossCluster|__crossDB|__executeAndCache|__id|__isFuzzy|__noWithSource|__packedColumn|__partitionby|__projectAway|__sourceColumnIndex|access|accumulate|alias|and|anomalychart|areachart|as|asc|assert-schema|bagexpansion|barchart|best_effort|between|bin|bin_legacy|bool|boolean|by|byte|cachingpolicy|callout|cancel|card|char|columnchart|commands-and-queries|consume|contains|contains_cs|containscs|count|cycles|database|dataexport|dataformat|datascope|datatable|date|datetime|datetime_pattern|decimal|declare|decodeblocks|default|desc|distinct|double|dynamic|earliest|edges|encodingpolicy|endswith|endswith_cs|entity_group|evaluate|expandoutput|extend|extent_tags_retention|external_data|externaldata|facet|filter|find|first|flags|float|force_remote|fork|from|getschema|granny-asc|granny-desc|graph|graph-mark-components|graph-match|graph-shortest-paths|graph-to-table|graph-where-edges|graph-where-nodes|guid|harddelete|hardretention|has|has_all|has_any|has_cs|hasprefix|hasprefix_cs|hassuffix|hassuffix_cs|hint\\.concurrency|hint\\.distribution|hint\\.materialized|hint\\.num_partitions|hint\\.progressive_top|hint\\.remote|hint\\.shufflekey|hint\\.spread|hint\\.strategy|hotcache|id|in|inline_external_table|int|int16|int32|int64|int8|invoke|in~|isfuzzy|join|journal|kind|ladderchart|last|latest|let|like|likecs|limit|linechart|long|lookup|macro-expand|make-graph|make-series|matches regex|materialize|materialized-view-combine|materialized-views|mdm|missing|mv-apply|mv-expand|mvapply|mvexpand|nodes|nooptimization|notcontains|notcontainscs|notlike|notlikecs|null|nulls|of|on|optional|or|order|others|output|pack|parse|parse-kv|parse-where|partition|partitioned-by|pathformat|pattern|piechart|pivotchart|plotly|print|project|project-away|project-by-names|project-keep|project-rename|project-reorder|project-smart|queries|query_parameters|query_results|range|real|reduce|regex|relaxed|render|restrict|restricted_view_access|row_level_security|rowstore|rowstore_references|rowstore_sealinfo|rowstorepolicy|rowstores|sample|sample-distinct|scan|scatterchart|seal|seals|search|serialize|set|set-or-append|set-or-replace|shards|simple|softdelete|softretention|sort|sql|stackedareachart|startswith|startswith_cs|statistics|step|storedqueryresultcontainers|string|summarize|tablepurge|take|time|timechart|timeline|timepivot|timespan|title|to|top|top-hitters|top-nested|toscalar|totable|treemap|typeof|uint|uint16|uint32|uint64|uint8|ulong|union|uniqueid|unrestrictedviewers|uuid|verbose|view|viewers|views|where|with|with_itemindex|with_match_id|with_node_id|with_source|with_step_name|withsource|writeaheadlog)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.kql",
          "match": "(!|!=|!~|%|\\(|\\)|\\*|\\+|,|-|--|-->|-\\[|\\.|\\.\\.|/|:|;|<|<--|<-\\[|<=|<>|<\\||=|==|=>|=~|>|>=|\\?|@|\\[|\\]|\\]-|\\]->|\\{|\\||\\})"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "support.function.builtin.kql",
          "match": "(?i)\\b(__cast|__geo_length_to_s2cell_level|__geo_line_s2cell_covering_level|__geo_line_validate|__geo_polygon_s2cell_covering_level|__geo_polygon_validate|__hash_crc32|__hash_djb2|__hash_many_crc32|__hash_xxh64|__hll_normalize|__invoke|__ipv6_lookup_ranges|__lz4_compress_dynamic_array_to_base64_string|abs|acos|ago|all|any|around|array_concat|array_iff|array_iif|array_index_of|array_length|array_reverse|array_rotate_left|array_rotate_right|array_shift_left|array_shift_right|array_slice|array_sort_asc|array_sort_desc|array_split|array_strcat|array_sum|arraylength|asin|assert|atan|atan2|bag_has_key|bag_keys|bag_merge|bag_pack|bag_pack_columns|bag_remove_keys|bag_set_key|bag_zip|base64_decode_toarray|base64_decode_toguid|base64_decode_tostring|base64_decodestring|base64_encode_fromarray|base64_encode_fromguid|base64_encode_tostring|base64_encodestring|beta_cdf|beta_inv|beta_pdf|bin|bin_at|bin_auto|binary_and|binary_not|binary_or|binary_shift_left|binary_shift_right|binary_xor|bitset_count_ones|case|ceiling|cluster|coalesce|column_ifexists|column_names_of|columnifexists|convert_angle|convert_energy|convert_force|convert_length|convert_mass|convert_speed|convert_temperature|convert_volume|cos|cot|countof|current_cluster_endpoint|current_cursor|current_database|current_node_id|current_principal|current_principal_details|current_principal_is_member_of|cursor_after|cursor_before_or_at|cursor_current|database|datepart|datetime_add|datetime_diff|datetime_list_timezones|datetime_local_to_utc|datetime_part|datetime_utc_to_local|dayofmonth|dayofweek|dayofyear|dcount_hll|degrees|dynamic_to_json|endofday|endofmonth|endofweek|endofyear|entity_group|erf|erfc|estimate_data_size|exp|exp10|exp2|extent_id|extent_tags|extentid|external_table|extract|extract_all|extract_json|extractall|extractjson|floor|format_bytes|format_datetime|format_ipv4|format_ipv4_mask|format_timespan|gamma|geo_angle|geo_azimuth|geo_closest_point_on_line|geo_closest_point_on_polygon|geo_distance_2points|geo_distance_point_to_line|geo_distance_point_to_polygon|geo_from_wkt|geo_geohash_neighbors|geo_geohash_to_central_point|geo_geohash_to_polygon|geo_h3cell_children|geo_h3cell_level|geo_h3cell_neighbors|geo_h3cell_parent|geo_h3cell_rings|geo_h3cell_to_central_point|geo_h3cell_to_polygon|geo_info_from_ip_address|geo_intersection_2lines|geo_intersection_2polygons|geo_intersection_line_with_polygon|geo_intersects_2lines|geo_intersects_2polygons|geo_intersects_line_with_polygon|geo_line_buffer|geo_line_centroid|geo_line_densify|geo_line_interpolate_point|geo_line_length|geo_line_locate_point|geo_line_simplify|geo_line_to_s2cells|geo_point_buffer|geo_point_in_circle|geo_point_in_polygon|geo_point_to_geohash|geo_point_to_h3cell|geo_point_to_s2cell|geo_polygon_area|geo_polygon_buffer|geo_polygon_centroid|geo_polygon_densify|geo_polygon_perimeter|geo_polygon_simplify|geo_polygon_to_h3cells|geo_polygon_to_s2cells|geo_s2cell_neighbors|geo_s2cell_to_central_point|geo_s2cell_to_polygon|geo_simplify_polygons_array|geo_union_lines_array|geo_union_polygons_array|getmonth|gettype|getyear|graph|gzip_compress_to_base64_string|gzip_decompress_from_base64_string|has_any_index|has_any_ipv4|has_any_ipv4_prefix|has_ipv4|has_ipv4_prefix|hash|hash_combine|hash_many|hash_md5|hash_sha1|hash_sha256|hash_xxhash64|hll_isvalid|hll_merge|hourofday|iff|iif|indexof|indexof_regex|ingestion_time|inner_nodes|ipv4_compare|ipv4_is_in_any_range|ipv4_is_in_range|ipv4_is_match|ipv4_is_private|ipv4_netmask_suffix|ipv4_range_to_cidr_list|ipv6_compare|ipv6_is_in_any_range|ipv6_is_in_range|ipv6_is_match|isascii|iscolumnexists|isempty|isfinite|isinf|isnan|isnotempty|isnotnull|isnull|isutf8|jaccard_index|labels|log|log10|log2|loggamma|make_datetime|make_string|make_timespan|map|materialized_view|max_of|merge_tdigest|min_of|monthofyear|new_guid|next|node_degree_in|node_degree_out|node_id|not|notempty|notnull|now|pack|pack_all|pack_array|pack_dictionary|parse_command_line|parse_csv|parse_ipv4|parse_ipv4_mask|parse_ipv6|parse_ipv6_mask|parse_json|parse_path|parse_url|parse_urlquery|parse_user_agent|parse_version|parse_xml|parsejson|parseurl|parseurlquery|percentile_tdigest|percentiles_array_tdigest|percentrank_tdigest|pi|pow|prev|punycode_domain_from_string|punycode_domain_to_string|punycode_from_string|punycode_to_string|radians|rand|range|rank_tdigest|regex_quote|repeat|replace|replace_regex|replace_string|replace_strings|reverse|round|row_cumsum|row_number|row_rank|row_rank_dense|row_rank_min|row_window_session|rowstore_ordinal_range|series_abs|series_acos|series_add|series_asin|series_atan|series_ceiling|series_cos|series_cosine_similarity|series_decompose|series_decompose_anomalies|series_decompose_forecast|series_divide|series_dot_product|series_equals|series_exp|series_fft|series_fill_backward|series_fill_const|series_fill_forward|series_fill_linear|series_fir|series_fit_2lines|series_fit_2lines_dynamic|series_fit_line|series_fit_line_dynamic|series_fit_poly|series_floor|series_greater|series_greater_equals|series_ifft|series_iir|series_less|series_less_equals|series_log|series_magnitude|series_multiply|series_not_equals|series_outliers|series_pearson_correlation|series_periods_detect|series_periods_validate|series_pow|series_product|series_seasonal|series_sign|series_sin|series_stats|series_stats_dynamic|series_subtract|series_sum|series_tan|set_difference|set_equals|set_has_element|set_intersect|set_union|sign|sin|split|sqrt|startofday|startofmonth|startofweek|startofyear|stored_query_result|strcat|strcat_array|strcat_delim|strcmp|string_size|strlen|strrep|substring|table|tan|tdigest_isvalid|tdigest_merge|to_utf8|tobool|toboolean|todatetime|todecimal|todouble|todynamic|toguid|tohex|toint|tolong|tolower|toobject|toreal|tostring|totime|totimespan|toupper|translate|treepath|trim|trim_end|trim_start|unicode_codepoints_from_string|unicode_codepoints_to_string|unixtime_microseconds_todatetime|unixtime_milliseconds_todatetime|unixtime_nanoseconds_todatetime|unixtime_seconds_todatetime|url_decode|url_encode|url_encode_component|week_of_year|weekofyear|welch_test|zip|zlib_compress_to_base64_string|zlib_decompress_from_base64_string|any|anyif|arg_max|arg_min|argmax|argmin|avg|avgif|binary_all_and|binary_all_or|binary_all_xor|buildschema|cnt|count|count_distinct|count_distinctif|countif|covariance|covarianceif|covariancep|covariancepif|dcount|dcountif|hll|hll_if|hll_merge|make_bag|make_bag_if|make_dictionary|make_list|make_list_if|make_list_with_nulls|make_set|make_set_if|makelist|makeset|max|maxif|merge_tdigest|min|minif|passthrough|percentile|percentiles|percentiles_array|percentilesw|percentilesw_array|percentilew|stdev|stdevif|stdevp|sum|sumif|take_any|take_anyif|tdigest|tdigest_merge|variance|varianceif|variancep|variancepif)\\b"
        }
      ]
    },
    "tables": {
      "patterns": [
        {
          "name": "support.class.table.kql",
          "match": "(?i)\\b(advisorresources|aksresources|alertsmanagementresources|appserviceresources|authorizationresources|awsresources|azurebusinesscontinuityresources|azuredevopsplatformresources|batchresources|capabilityresources|chaosresources|communitygalleryresources|computeresources|containerserviceeventresources|deploymentresources|desktopvirtualizationresources|dnsresources|edgeorderresources|elasticsanresources|extendedlocationresources|extensibilityresourcechanges|featureresources|gcpresources|guestconfigurationresources|healthresourcechanges|healthresources|impactreportresources|insightsresources|iotsecurityresources|kubernetesconfigurationresources|kustoresources|machinesinventoryinsightsresources|maintenanceresourcechanges|maintenanceresources|managedservicesresources|migrateresources|networkresourcechanges|networkresources|orbitalresources|patchassessmentresources|patchinstallationresources|policyresources|quotaresourcechanges|recoveryservicesresources|resourcechanges|resourcecontainerchanges|resourcecontainers|resources|securityresources|servicefabricresources|servicehealthresources|sharedgalleryresources|spotresources|tagsresources|insightresources|managedserviceresources|mirgateresources|sportresources|tagresources)\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.kql",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.kql",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.quoted.single.kql",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.kql",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.kql",
          "match": "\\b([0-9]+\\.?[0-9]*([eE][+-]?[0-9]+)?[fdm]?)\\b"
        },
        {
          "name": "constant.numeric.hex.kql",
          "match": "\\b0[xX][0-9a-fA-F]+\\b"
        }
      ]
    },
    "properties": {
      "patterns": [
        {
          "name": "variable.other.property.kql",
          "match": "(?i)\\b(advisor|containerservice|compute|network|gcpconnector|iotfirmwaredefense|iotsecurity|offazure|maintenance|applicationmigration|migrate|mysqldiscovery|recoveryservices|management|resources|observabilityeval|astro|services|contentstore|storage|observability|enterprise|datamanagement|hyperexecute|samplerp|microsoft apps|aad|aadiam|agfoodplatform|agricultureplatform|alertsmanagement|alicespringsdataplane|analysisservices|anybuild|apicenter|apimanagement|app|appassessment|appconfiguration|applink|appplatform|appsecurity|arcnetworking|aszlabhardware|attestation|authorization|automanage|automation|autonomousdevelopmentplatform|autonomoussystems|avs|awsconnector|azureactivedirectory|azurearcdata|azurecis|azuredata|azuredatatransfer|azurefleet|azureimagetestingforlinux|azurelargeinstance|azurepercept|azureplaywrightservice|azurescan|azuresphere|azurestack|azurestackhci|backupsolutions|bakeryhybrid|baremetal|baremetalinfrastructure|batch|billingbenefits|bing|biztalkservices|bluefin|botservice|cache|cdn|certificateregistration|chaos|classiccompute|classicnetwork|classicstorage|cleanroom|clouddeviceplatform|cloudes|cloudhealth|cloudtest|clusterstor|codesigning|codespaces|cognition|cognitivesearch|cognitiveservices|community|compositesolutions|computeschedule|confidentialledger|confluent|connectedcache|connectedcredentials|connectedopenstack|connectedvehicle|connectedvmwarevsphere|containerinstance|containerregistry|containerstorage|contoso|costmanagement|customproviders|d365customerinsights|dashboard|dataaccelerator|databasefleetmanager|databasewatcher|databox|databoxedge|databricks|datacollaboration|datadog|datafactory|datalakeanalytics|datalakestore|datamigration|dataplatform|dataprotection|datareplication|datashare|dbformariadb|dbformysql|dbforpostgresql|delegatednetwork|dependencymap|desktopvirtualization|devai|devcenter|developmentwindows365|devhub|deviceonboarding|deviceregistry|devices|deviceupdate|devops|devopsinfrastructure|devtestlab|devtunnels|digitaltwins|discovery|dns|documentdb|domainregistration|durabletask|dynamics365fraudprotection|easm|edge|edgeorder|edgezones|elastic|energydataplatform|enterprisesupport|entraidgovernance|eventgrid|eventhub|experimentation|extendedlocation|fabric|fairfieldgardens|falcon|fidalgo|fileshares|fluidrelay|footprintmonitoring|gaming|graph|graphservices|hanaonazure|hardware|hardwaresecuritymodules|hdinsight|healthbot|healthcareapis|healthcareinterop|healthdataaiservices|healthmodel|healthplatform|hpcworkbench|hybridcloud|hybridcompute|hybridconnectivity|hybridcontainerservice|hybriddata|hybridnetwork|ibmpower|importexport|insights|integrationspaces|iotcentral|iotoperations|iotoperationsdataprocessor|iotoperationsmq|iotoperationsorchestrator|keyvault|kubernetes|kubernetesconfiguration|kusto|labservices|liftrpilot|loadtestservice|logic|machinelearning|machinelearningservices|managedidentity|managednetworkfabric|managedstorageclass|manufacturingplatform|maps|messagingcatalog|messagingconnectors|metaverse|mission|mixedreality|mobilenetwork|mobilepacketcore|modsimworkbench|monitor|netapp|networkanalytics|networkcloud|networkfunction|nexusidentity|notificationhubs|nutanix|objectstore|offazurespringboot|onlineexperimentation|openenergyplatform|openlogisticsplatform|operationalinsights|operationsmanagement|oraclediscovery|orbital|peering|pki|playfab|portal|portalsdk|portalservices|powerbi|powerbidedicated|powerplatform|premonition|professionalservice|programmableconnectivity|proposal|providerhub|purview|quantum|recommendationsservice|redhatopenshift|relay|remoteapp|resiliency|resourceconnector|resourcegraph|saas|saashub|scom|scvmm|search|secretmanagementsampleprovider|secretsynccontroller|security|securitycopilot|securitydetonation|securitydevops|securityplatform|sentinelplatformservices|servicebus|servicefabric|servicefabricmesh|servicenetworking|serviceshub|signalrservice|singularity|skytap|softwareplan|solutions|sovereign|spoolservice|sql|sqlvirtualmachine|standbypool|storageactions|storagecache|storagediscovery|storageinsights|storagemover|storagepool|storagesync|storagetasks|storsimple|streamanalytics|sustainabilityservices|swiftlet|symphony|synapse|syntex|systemintegritymonitoring|testbase|throttling|timeseriesinsights|toolchainorchestrator|updatemanager|usagebilling|verifiedid|videoindexer|virtualmachineimages|visualstudio|vmware|voiceservices|vsonline|web|weightsandbiases|whiteboxcadlprovider|windows365|windowsesu|windowsiot|windowspushnotificationservices|workloadbuilder|workloads|zerotrustsegmentation|atlas|postgres|nginxplus|database|cloudngfw|vectordb|test|block|qaas|email|fusion)\\b"
        },
        {
          "name": "variable.other.property.dot.kql",
          "match": "\\.[a-zA-Z_][a-zA-Z0-9_]*"
        }
      ]
    }
  }
}